<!DOCTYPE html>
<!--
Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
Click nbfs://nbhost/SystemFileSystem/Templates/Other/html.html to edit this template
-->
<html>
    <head>
        <title>Buscar - FAIND MAP</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <link rel="icon" href="/imagens/logo.png" />
        
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.13.2/themes/base/jquery-ui.min.css" integrity="sha512-ELV+xyi8IhEApPS/pSj66+Jiw+sOT1Mqkzlh8ExXihe4zfqbWkxPRi8wptXIO9g73FSlhmquFlUOuMSoXz5IRw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
        <link href="site.css" rel="stylesheet">
    </head>
    <body id="body_buscar">
        <section id="pagina_buscar" class="container">
            <form action="/rota" method="POST">

                <div class="inputs">
                    <div class="form-floating mb-3">
                        <input type="search" class="form-control search" name="origem" id="origem" placeholder="De Onde?" data-id="idOrigem" required />
                        <input type="hidden" name="idOrigem" id="idOrigem" />
                        <label for="origem">De Onde?</label>
                    </div>

                    <div class="form-floating mb-3">
                        <input type="search" class="form-control search" name="destino" id="destino" placeholder="Para Onde?" data-id="idDestino" required />
                        <input type="hidden" name="idDestino" id="idDestino" />
                        <label for="destino">Para Onde?</label>
                    </div>
                </div>

                <button class="btn btn-primary">PESQUISAR CAMINHO</button>

            </form>
        </section>
        
        <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.13.2/jquery-ui.min.js" integrity="sha512-57oZ/vW8ANMjR/KQ6Be9v/+/h6bq9/l3f0Oc7vn6qMqyhvPd1cvKBRWWpzu0QoneImqr2SkmO4MSqU+RpHom3Q==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

        <script type="text/javascript">
            $(function () {            
                $('.search').autocomplete({
                    source: function (request, response) {
                        let vertices;
                        $.ajax({
                            url: 'http://190.111.176.23:8081/faindmap/vertice',
                            dataType: 'json',
                            success: function (data) {
                                vertices = data.content.filter((v) => v.nome.toLowerCase().includes(request.term));

                                response(vertices.map(function(v) {
                                        return { id: v.id_vertice, value: `${v.nome} - ${v.bloco.nome} - ${v.campus.descricao}` }
                                    }
                                ));
                            }
                         });
                    },
                    minLength: 0,
                    select: function (event, ui) {
                        let id = event.target.dataset.id;
                        $(`#${id}`).val(ui.item.id);
                        console.log(id);
                        console.log(ui.item);
                    }
                }).focus(function (event) {
                    $(event.target).autocomplete('search', '');
                });
            });
        </script>
    </body>
</html>
